<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Devi Technical Services ‚Äî Bill Generator</title>
    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <!-- Custom Styles -->
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <nav>
        <span class="nav-brand"><i>DT</i> Devi Technical Services <span>/ Bill Generator</span></span>
        <div class="nav-tabs">
            <div class="nav-tab active" data-tab="form">‚úèÔ∏è Fill Form</div>
            <div class="nav-tab" data-tab="upload">üìÑ Upload CSV</div>
        </div>
    </nav>

    <div class="page">

        <!-- Security Gate -->
        <div id="security-gate">
            <div class="gate-card">
                <h2>Authorized Access Only</h2>
                <p>Please enter the security password to access the Bill Generator.</p>
                <input type="password" id="gate-pass" placeholder="Enter password" />
                <button id="gate-btn">Verify Access</button>
                <div id="gate-error" style="color: #ef4444; margin-top: 12px; font-size: 14px; display: none;">
                    Invalid password. Please try again.
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê TAB 1: FORM INPUT ‚ïê‚ïê‚ïê -->
        <div class="section active" id="sec-form">

            <!-- Invoice Details -->
            <div class="card">
                <div class="card-hd">üìÑ Bill Details</div>
                <div class="fg">
                    <div class="field">
                        <label>Bill Number</label>
                        <input type="text" id="f-invNo" placeholder="e.g. 131" />
                    </div>
                    <div class="field">
                        <label>Bill Date</label>
                        <input type="date" id="f-invDate" />
                    </div>
                </div>
            </div>

            <!-- Receiver -->
            <div class="card">
                <div class="card-hd">üë§ Receiver / Billed To</div>
                <div class="fg">
                    <div class="field">
                        <label>Party Name</label>
                        <input type="text" id="f-recvName" placeholder="e.g. Pristine Utilities Pvt. Ltd." />
                    </div>
                    <div class="field">
                        <label>Full Address</label>
                        <textarea id="f-recvAddr" placeholder="Street, City, Pincode..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Items  -->
            <div class="card">
                <div class="card-hd">üõ† Products / Services</div>
                <div class="items-table-wrapper">
                    <table class="items-table">
                        <thead>
                            <tr>
                                <th style="width:5%">#</th>
                                <th style="width:40%">Product / Service Selection</th>
                                <th style="width:10%">HSN/SAC</th>
                                <th style="width:10%">UOM</th>
                                <th style="width:8%">Qty</th>
                                <th style="width:12%" class="r">Rate</th>
                                <th style="width:12%" class="r">Total</th>
                                <th style="width:3%"></th>
                            </tr>
                        </thead>
                        <tbody id="items-body"></tbody>
                    </table>
                </div>
                <button class="btn-add-row" id="btn-add-item">+ Add New Item Row</button>
            </div>

            <!-- Bank Details -->
            <div class="card">
                <div class="card-hd">üè¶ Bank Details</div>
                <div class="fg full">
                    <div class="field">
                        <label>Select Bank Account</label>
                        <select id="f-bank">
                            <option value="0">Jaya Mishra ‚Äî A/C 677802010011687, Union Bank, IFSC: UBIN0567787</option>
                            <option value="1">Devi Technical Services ‚Äî A/C 920020043613270, Axis Bank, IFSC:
                                UTIB0001234</option>
                            <option value="custom">‚úèÔ∏è Custom (type below)</option>
                        </select>
                    </div>
                    <div class="field" id="custom-bank-field" style="display:none;">
                        <label>Custom Bank Details</label>
                        <textarea id="f-bankCustom"
                            placeholder="Account Name, Number, Bank Name, IFSC code..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="btn-row">
                <button class="btn btn-primary" id="btn-preview">üëÅ Preview Bill</button>
                <button class="btn btn-outline" id="btn-reset-form">‚Ü© Clear Form</button>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê TAB 2: CSV UPLOAD ‚ïê‚ïê‚ïê -->
        <div class="section" id="sec-upload">
            <div class="card" style="padding: 40px;">
                <div class="card-hd" style="border:none; justify-content:center; font-size: 20px;">üì§ Professional CSV
                    Upload</div>
                <div class="drop-zone" id="drop-zone">
                    <div class="drop-icon-container">
                        <span class="drop-icon">üìä</span>
                    </div>
                    <div class="drop-main">Drop your CSV file here to generate Bill</div>
                    <div class="drop-sub">Supported format: .csv (Comma Separated Values)</div>
                    <input type="file" id="file-input" accept=".csv" />
                    <button class="btn btn-primary" style="margin-top:10px;">Browse Files</button>
                </div>

                <div class="error-box" id="error-box">‚ö†Ô∏è <span id="error-msg"></span></div>

                <div class="btn-row">
                    <a href="sample-invoice.csv" download class="btn btn-outline">üìÑ Download Template CSV</a>
                </div>

                <div class="notice">
                    <span style="font-size:20px;">üõ°Ô∏è</span>
                    <span>Secure Local Processing: Your data stays on your machine. No cloud storage used.</span>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê PREVIEW / RESULT ‚ïê‚ïê‚ïê -->
        <div class="section" id="sec-preview">
            <div class="action-bar">
                <div class="action-info">Bill <strong id="info-number"></strong> summary for <strong
                        id="info-customer"></strong></div>
                <div style="display:flex;gap:12px;flex-wrap:wrap;">
                    <button class="btn btn-outline" id="btn-back-edit"
                        style="border-color:#fff; color:#fff; background:rgba(255,255,255,0.1)">‚úèÔ∏è Back to Edit</button>
                    <button class="btn btn-primary" id="btn-download"
                        style="background:#FCA311; color:#000; box-shadow:none;">‚¨á Download Professional PDF</button>
                </div>
            </div>

            <div class="preview-scroll">
                <div id="invoice-render"></div>
            </div>

            <div class="btn-row">
                <button class="btn btn-outline" id="btn-new2" style="background:#fff;">üóë Start New Bill</button>
            </div>
        </div>

    </div>

    <div class="toast" id="toast"></div>

    <!-- Custom Logic -->
    <script src="script.js"></script>
</body>

</html>